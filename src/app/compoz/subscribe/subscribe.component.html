<div class="container col-md-6 mt-4">
  <form [formGroup]="subForm" (ngSubmit)="register()">
    <h2 class="mb-4">Qui êtes vous ?</h2>
    <!-- NAME -->
    <div class="form-floating mb-3" >
      <input type="text" class="form-control" id="subName" formControlName="name">
      <label for="subName" class="form-label">Nom</label>
      <div *ngIf="subForm.get('name')?.touched" class="errmsg">
        <small *ngIf="subForm.get('name')?.hasError('pattern')" class="text-danger ps-2">
          <i class="fa-solid fa-xmark"></i>
          Votre nom ne peut contenir que des lettres sans accents, des chiffres et l’underscore
        </small>
        <small *ngIf="subForm.get('name')?.hasError('usernameTaken')" class="text-danger ps-2">
          <i class="fa-solid fa-xmark"></i>
          Désolé, ce nom d’utilisateur est déjà pris
        </small>
      </div>
    </div>
    <!-- PASSWORD -->
    <div class="form-floating mb-3">
      <input type="password" class="form-control" id="subPass1" formControlName="password" #pass>
      <label for="subPass1" class="form-label">Mot de passe</label>
      <div *ngIf="subForm.get('password')?.touched" class="errmsg">
        <small *ngIf="subForm.get('password')?.hasError('pattern')" class="text-danger ps-2">
          <i class="fa-solid fa-xmark"></i>
          Le mot de passe doit faire 8 caractères minimum et comporter au moins une minuscule, une majuscule et un chiffre
        </small>
        <small *ngIf="subForm.get('password')?.hasError('maxlength')" class="text-danger ps-2">
          <i class="fa-solid fa-xmark"></i>
          Le mot de passe ne doit pas dépasser 30 caractères
        </small>
      </div>
    </div>
    <!-- PASSWORD CONFIRM -->
    <div class="form-floating mb-3" *ngIf="pass.value">
      <input type="password" class="form-control" id="subPass2" formControlName="confirmPassword" 
      [class.customInvalid]="subForm.hasError('passwordDontMatch') && subForm.get('confirmPassword')?.touched">
      <label for="subPass2" class="form-label">Confirmer le mot de passe</label>
      <div *ngIf="subForm.get('confirmPassword')?.touched" class="errmsg">
        <small *ngIf="subForm.hasError('passwordDontMatch')" class="text-danger ps-2">
          <i class="fa-solid fa-xmark"></i>
          veuillez confirmer le mot de passe
        </small>
      </div>
    </div>
    <!-- MAIL -->
    <div class="form-floating mb-3">
      <input type="text" class="form-control" id="subMail" formControlName="email">
      <label for="subMail" class="form-label">Adresse mail</label>
      <div *ngIf="subForm.get('email')?.touched" class="errmsg">
        <small *ngIf="subForm.get('email')?.invalid" class="text-danger ps-2">
          <i class="fa-solid fa-xmark"></i>veuillez entrer une adresse valide
        </small>
      </div>
    </div>
    <!-- AVATAR -->
    <div class="form-floating mb-3">
      <input type="text" class="form-control nocheck" id="subAvatar" formControlName="avatar" #avatar>
      <label for="subAvatar" class="form-label">Avatar (facultatif)</label>
    </div>
    <div *ngIf="avatar.value">
      <img src="{{avatar.value}}" class="mb-3 imgpreview">
    </div>
    <!-- SUBMIT -->
    <button
      [disabled]="!subForm.valid"
      class="btn btn-primary"
      type="submit"
      >S’inscrire</button>
  </form>
</div>